<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ resume.name }} - {{ resume.title or 'Resume' }}</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        /* keep original styling but allow static override */
        * {margin:0;padding:0;box-sizing:border-box}
        body{font-family:Calibri, Arial, sans-serif;background:#f8f9fa;padding:20px;line-height:1.5;color:#2c3e50}
        .resume-container{max-width:1000px;margin:0 auto;background:white;box-shadow:0 2px 10px rgba(0,0,0,0.1);display:flex;min-height:900px;border-radius:8px;overflow:hidden}
        .sidebar{width:320px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:40px 30px;position:relative}
        .sidebar::after{content:'';position:absolute;top:0;right:0;width:4px;height:100%;background:linear-gradient(45deg,#f093fb 0%,#f5576c 100%)}
        .main-content{flex:1;padding:40px 50px;background:#ffffff}
        .profile-section{text-align:center;margin-bottom:40px}
        .profile-img{width:160px;height:160px;border-radius:50%;border:4px solid rgba(255,255,255,0.3);margin-bottom:20px;background-size:cover;background-position:center}
        .name{font-size:24px;font-weight:700;margin-bottom:5px;text-transform:uppercase;letter-spacing:1px}
        .title{font-size:14px;color:rgba(255,255,255,0.9);margin-bottom:25px;font-weight:500}
        .contact-info{margin-bottom:30px}
        .contact-item{margin-bottom:15px;display:flex;align-items:center;font-size:14px}
        .contact-item::before{content:'▶';color:#f093fb;margin-right:10px;font-size:10px}
        .section-title{font-size:16px;font-weight:700;margin-bottom:20px;text-transform:uppercase;color:rgba(255,255,255,0.95);border-bottom:2px solid #f093fb;padding-bottom:8px}
        .skills-list{list-style:none;margin-bottom:30px}
        .skills-list li{margin-bottom:12px;font-size:14px;position:relative;padding-left:20px}
        .skills-list li::before{content:'▸';position:absolute;left:0;color:#f093fb}
        .skill-bar{height:6px;background:#34495e;border-radius:3px;margin-top:5px;overflow:hidden}
        .skill-progress{height:100%;background:linear-gradient(90deg,#f093fb 0%,#f5576c 100%);border-radius:3px}
        .main-section{margin-bottom:40px}
        .main-section h2{font-size:18px;font-weight:700;margin-bottom:15px;text-transform:uppercase;color:#667eea;border-bottom:3px solid #667eea;padding-bottom:8px}
        .profile-text{font-size:14px;color:#555;margin-bottom:20px;text-align:justify;line-height:1.6}
        .experience-item,.education-item{margin-bottom:25px}
        .exp-header,.edu-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
        .job-title,.degree{font-size:15px;font-weight:700;color:#2c3e50}
        .company,.school{font-size:13px;color:#667eea;font-weight:600}
        .duration{font-size:13px;color:#7f8c8d;font-style:italic}
        .exp-description,.edu-description{font-size:14px;color:#555;margin-top:8px}
        .reference-item{margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid #ecf0f1}
        .ref-name{font-size:15px;font-weight:bold;color:#2c3e50;margin-bottom:5px}
        .ref-position{font-size:13px;color:#667eea;margin-bottom:3px}
        .ref-company{font-size:13px;color:#7f8c8d;margin-bottom:8px}
        .ref-contact{font-size:13px;color:#555}
        .language-list,.hobbies-list{list-style:none}
        .language-list li,.hobbies-list li{margin-bottom:10px;font-size:14px}
        .hobbies-list li::before{content:'♥';position:absolute;left:0;color:#f093fb}
        .download-btn{position:fixed;top:20px;right:20px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:12px 24px;border:none;border-radius:25px;cursor:pointer;font-size:14px;font-weight:600;text-transform:uppercase;letter-spacing:1px;box-shadow:0 4px 15px rgba(102,126,234,0.3);z-index:1000}
        @media (max-width:768px){.resume-container{flex-direction:column}.sidebar,.main-content{width:100%}.sidebar::after{display:none}}
    </style>
</head>
<body>
    <button class="download-btn" onclick="downloadPDF()">Download PDF</button>
    
    <div class="resume-container" id="resume">
        <div class="sidebar">
            <div class="profile-section">
                <div class="profile-img" style="background-image: url('{{ resume.profile_img or '/static/images/Shuvo.jpg' }}')"></div>
                <div class="name">{{ resume.name }}</div>
                <div class="title">{{ resume.title }}</div>
            </div>

            <div class="contact-info">
                <div class="section-title">Contact</div>
                {% if resume.contact.phone %}<div class="contact-item">{{ resume.contact.phone }}</div>{% endif %}
                {% if resume.contact.email %}<div class="contact-item">{{ resume.contact.email }}</div>{% endif %}
                {% if resume.contact.location %}<div class="contact-item">{{ resume.contact.location }}</div>{% endif %}
                {% if resume.contact.availability %}<div class="contact-item">{{ resume.contact.availability }}</div>{% endif %}
            </div>

            <div class="skills-section">
                <div class="section-title">Skills</div>
                <ul class="skills-list">
                    {% for skill in resume.skills %}
                    <li>{{ skill }}{% if resume.skill_levels and resume.skill_levels[skill] %}
                        <div class="skill-bar"><div class="skill-progress" style="width: {{ resume.skill_levels[skill] }}%"></div></div>
                        {% endif %}
                    </li>
                    {% endfor %}
                </ul>
            </div>

            {% if resume.languages %}
            <div class="languages-section">
                <div class="section-title">Languages</div>
                <ul class="language-list">
                    {% for lang in resume.languages %}
                    <li>{{ lang.name }} <span class="lang-level">{{ lang.level }}</span></li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}

            {% if resume.hobbies %}
            <div class="hobbies-section">
                <div class="section-title">Hobbies</div>
                <ul class="hobbies-list">
                    {% for h in resume.hobbies %}
                    <li>{{ h }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
        </div>

        <div class="main-content">
            <div class="main-section">
                <h2>Profile</h2>
                <p class="profile-text">{{ resume.summary }}</p>
            </div>

            <div class="main-section">
                <h2>Professional Experience</h2>
                {% for job in resume.experience %}
                <div class="experience-item">
                    <div class="exp-header">
                        <div>
                            <div class="job-title">{{ job.title }}</div>
                            <div class="company">{{ job.company }}</div>
                        </div>
                        <div class="duration">{{ job.duration }}</div>
                    </div>
                    <div class="exp-description">
                        <ul>
                        {% for d in job.description %}
                            <li>{{ d }}</li>
                        {% endfor %}
                        </ul>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div class="main-section">
                <h2>Education</h2>
                {% for ed in resume.education %}
                <div class="education-item">
                    <div class="edu-header">
                        <div>
                            <div class="degree">{{ ed.degree }}</div>
                            <div class="school">{{ ed.school }}</div>
                        </div>
                        <div class="duration">{{ ed.duration }}</div>
                    </div>
                    <div class="edu-description">{{ ed.description }}</div>
                </div>
                {% endfor %}
            </div>

            <div class="main-section">
                <h2>Services & Expertise</h2>
                <div class="experience-item">
                    <div class="exp-description">
                        {% for s in resume.services %}
                        <strong>{{ s.title }}:</strong> {{ s.description }}<br><br>
                        {% endfor %}
                    </div>
                </div>
            </div>

            {% if resume.testimonials %}
            <div class="main-section">
                <h2>Client Testimonials</h2>
                {% for t in resume.testimonials %}
                <div class="reference-item">
                    <div class="ref-name">{{ t.name }}</div>
                    <div class="ref-position">{{ t.position }}</div>
                    <div class="ref-company">{{ t.company }}</div>
                    <div class="ref-contact">"{{ t.text }}"</div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>

    <script>
        function downloadPDF() {
            const element = document.getElementById('resume');
            const opt = {margin:10, filename: 'resume.pdf', image:{type:'jpeg',quality:0.98}, html2canvas:{scale:2}, jsPDF:{unit:'mm', format:'a4', orientation:'portrait'}};
            const btn = document.querySelector('.download-btn');
            const originalText = btn.textContent;
            btn.textContent = 'Generating...'; btn.disabled = true;
            html2pdf().set(opt).from(element).save().then(()=>{btn.textContent = originalText; btn.disabled=false}).catch((e)=>{console.error(e);btn.textContent='Error';setTimeout(()=>btn.textContent=originalText,1500)})
        }
    </script>
</body>
</html>
